<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#0b1020" />
    <title>오프라인 가계부</title>
    <link rel="manifest" href="manifest.webmanifest" />
    <link rel="apple-touch-icon" href="icons/icon-192.png" />
    <script src="xlsx.full.min.js"></script>
    <style>
        :root{
          --bg:#0b1020; --text:#e9ecf5; --muted:#aab2d5; --line:rgba(255,255,255,.10);
          --good:#2dd4bf; --bad:#fb7185; --warn:#fbbf24;
          --shadow: 0 10px 30px rgba(0,0,0,.35);
        }
        *{ box-sizing:border-box; }
        body{
          margin:0;
          background: radial-gradient(1200px 700px at 20% 0%, #182357 0%, var(--bg) 55%);
          color:var(--text);
          font-family: system-ui, -apple-system, Segoe UI, Roboto, Apple SD Gothic Neo, "Noto Sans KR", Arial, sans-serif;
          line-height:1.4;
        }
        .appHeader{
          position:sticky; top:0; z-index:10;
          backdrop-filter: blur(10px);
          background: rgba(10, 14, 30, .72);
          border-bottom:1px solid var(--line);
        }
        .headerInner{
          max-width:1100px; margin:0 auto; padding:12px 14px;
          display:flex; align-items:center; justify-content:center;
        }
        .navTabs{
          display:flex; gap:8px; flex-wrap:nowrap; justify-content:center;
          overflow-x:auto; -webkit-overflow-scrolling: touch; padding-bottom:2px;
        }
        .navTabs::-webkit-scrollbar{ height:0; }
        .navBtn{
          border:1px solid var(--line);
          background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
          color:var(--text);
          padding:10px 12px;
          border-radius:12px;
          cursor:pointer;
          font-weight:700;
          box-shadow: 0 6px 16px rgba(0,0,0,.25);
          transition: .12s transform ease, .12s background ease, .12s border ease;
          white-space:nowrap;
          flex: 0 0 auto;
        }
        .navBtn:hover{ transform: translateY(-1px); }
        .navBtn.active{
          background: linear-gradient(180deg, rgba(45,212,191,.25), rgba(45,212,191,.08));
          border-color: rgba(45,212,191,.35);
        }

        main{ max-width:1100px; margin:0 auto; padding:18px 14px 40px; }
        .page{ display:none; }
        .page.active{ display:block; }

        .grid{ display:grid; grid-template-columns: repeat(12, 1fr); gap:12px; }
        .card{
          grid-column: span 12;
          background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
          border:1px solid var(--line);
          border-radius:16px;
          box-shadow: var(--shadow);
          padding:14px;
        }
        .cardTitle{
          display:flex; align-items:center; justify-content:space-between;
          gap:10px; margin-bottom:10px; flex-wrap:wrap;
        }
        .cardTitle h2{ margin:0; font-
</div>
                <div class="row" style="margin-bottom:10px;">
                    <div class="chip" id="historyCount">0건</div>
                    <div class="chip bad" id="historySumExpense">지출 0원</div>
                    <div class="chip good" id="historySumIncome">수입 0원</div>
                    <div class="spacer"></div>
                    <button class="btn" type="button" id="quickToAdd">+ 추가로 이동</button>
                </div>
                <div id="historyList" class="list"></div>
            </div>
        </div>
    </section>

    <!-- 설정 -->
    <section id="settings" class="page">
        <div class="grid">
            <div class="card">
                <div class="cardTitle">
                    <h2>백업 / 복원</h2>
                    <div class="muted" style="font-size:12px;">JSON/CSV/XLSX 내보내기 + JSON 가져오기</div>
                </div>

                <div class="row" style="gap:10px; margin-bottom:12px;">
                    <button class="btn primary" type="button" id="exportJson">JSON 내보내기</button>
                    <button class="btn" type="button" id="exportXlsx">엑셀(xlsx) 내보내기</button>
                </div>

                <div class="card" style="background: rgba(0,0,0,.14); box-shadow:none;">
<div class="card" style="background: rgba(0,0,0,.14); box-shadow:none;">
                    <div class="muted" style="font-size:12px; margin-bottom:10px;">
                        JSON 파일 가져오기: 파일 선택 후 합치기/덮어쓰기 선택
                    </div>
                    <div class="row" style="gap:10px;">
                        <input id="importFile" type="file" accept=".json,application/json" />
                        <button class="btn" type="button" id="importBtn">가져오기</button>
                    </div>
                </div>

                <div class="card" style="background: rgba(0,0,0,.14); box-shadow:none; margin-top:12px;">
                    <div class="muted" style="font-size:12px; margin-bottom:10px;">
                        JSON 텍스트 붙여넣기 복원: 백업 텍스트를 붙여넣고 복원
                    </div>
                    <textarea id="importText" placeholder="여기에 JSON 텍스트 붙여넣기" style="height:160px;"></textarea>
                    <div class="actions" style="margin-top:10px;">
                        <button class="btn" type="button" id="importTextBtn">붙여넣기 복원</button>
                    </div>
                </div>

                <div class="card" style="background: rgba(0,0,0,.14); box-shadow:none; margin-top:12px;">
                    <div class="row">
                        <div>
                            <div style="font-weight:900;">전체 삭제</div>
                            <div class="muted" style="font-size:12px;">이 기기에 저장된 내역이 모두 삭제됨</div>
                        </div>
                        <div class="spacer"></div>
                        <button class="btn danger" type="button" id="clearAll">전체 삭제</button>
                    </div>
                </div>

                <div class="help" style="margin-top:12px;">
                    참고: 이 앱은 <b>localStorage</b>에 저장돼. 같은 브라우저/기기에서만 유지되고, 브라우저 데이터 삭제 시 사라질 수 있어.
                </div>
            </div>
        </div>
    </section>
</main>

<div id="toast" class="toast" role="status" aria-live="polite"></div>

<!-- 백업 모달 -->
<div id="backupModal" style="
    position:fixed; inset:0; background:rgba(0,0,0,.55);
    display:none; align-items:center; justify-content:center; padding:14px; z-index:9999;">
    <div style="width:min(900px, 100%); background:rgba(10,14,30,.96);
      border:1px solid rgba(255,255,255,.12); border-radius:16px; padding:14px; box-shadow:0 10px 30px rgba(0,0,0,.45);">
        <div style="display:flex; gap:10px; align-items:center; justify-content:space-between; flex-wrap:wrap;">
            <div style="font-weight:900;">백업 텍스트</div>
            <div style="display:flex; gap:8px; flex-wrap:wrap;">
                <button type="button" id="backupCopyBtn" class="btn">복사</button>
                <button type="button" id="backupCloseBtn" class="btn danger">닫기</button>
            </div>
        </div>
        <div class="muted" style="font-size:12px; margin:8px 0 10px;">
            공유/다운로드가 막힌 환경이면 아래 내용을 복사해서 메모앱 등에 저장해.
        </div>
        <textarea id="backupText" style="width:100%; height:52vh; font-family: ui-monospace, SF
renderAll();
    })();
</script>
</body>
</html>
